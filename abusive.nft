table inet filter {
    set abuse-mail {
        type ipv4_addr
        flags interval
        auto-merge
        elements = { 45.146.130.0/24, 59.112.0.0-59.123.255.255,
                 60.249.159.94, 61.12.86.0/24,
                 62.60.188.0/22, 74.112.64.182,
                 77.90.185.6, 81.30.107.0/24,
                 85.140.60.0/23, 113.125.155.158,
                 129.41.173.76, 171.22.28.26,
                 185.170.167.0/24, 193.46.255.0/24,
                 210.202.31.42 }
    }

    set abuse-http {
        type ipv4_addr
        flags interval,timeout
        auto-merge
        elements = { 1.178.32.0/19, 3.22.0.0/16,
                 3.129.208.0/24, 3.142.0.0/16,
                 4.227.36.0/24, 5.9.0.0/16,
                 5.75.128.0/17, 5.161.0.0/16,
                 8.208.0.0/12, 13.59.0.0/16,
                 14.137.132.0-14.137.143.255, 14.137.152.0-14.137.157.255,
                 14.137.161.0/24, 14.137.169.0-14.137.175.255,
                 18.118.0.0/15, 18.217.0.0/16,
                 18.221.0.0-18.223.255.255, 23.88.0.0/17,
                 27.78.246.137, 27.106.0.0/17,
                 27.255.0.0-27.255.23.255, 27.255.26.0-27.255.29.255,
                 27.255.32.0-27.255.55.255, 27.255.58.0-27.255.61.255,
                 34.9.181.184, 36.128.0.0/10,
                 37.27.0.0/16, 42.201.128.0/17,
                 43.130.0.0/17, 43.130.224.0-43.131.63.255,
                 43.135.128.0/18, 43.152.72.0/23,
                 43.153.0.0/17, 43.157.0.0-43.157.191.255,
                 43.159.128.0/18, 43.160.0.0/12,
                 43.225.140.0/22, 43.255.104.0/22,
                 45.5.48.0/22, 45.40.50.0/24,
                 45.145.227.0/24, 45.194.104.0/21,
                 45.199.144.0/22, 45.202.128.0/18,
                 45.203.40.0/21, 45.240.0.0/13,
                 46.4.0.0/16, 46.62.128.0/17,
                 46.250.160.0/19, 47.76.0.0/16,
                 47.79.0.0/16, 47.82.0.0/16,
                 47.235.0.0-47.246.255.255, 49.0.192.0/20,
                 49.0.224.0/19, 49.12.0.0/15,
                 49.51.64.0-49.51.255.255, 50.114.203.0/24,
                 51.222.253.0/24, 52.14.0.0/16,
                 54.36.148.0/23, 57.141.0.0-57.149.255.255,
                 59.103.33.0/24, 59.120.113.205,
                 60.249.159.94, 62.245.0.0/19,
                 64.124.8.188, 65.21.0.0/16,
                 65.108.0.0/15, 66.220.149.0/24,
                 66.249.65.105, 68.235.45.0/24,
                 69.171.249.0/24, 73.46.21.251,
                 78.46.0.0/15, 78.138.62.0/24,
                 79.166.0.0/16, 80.238.128.0/19,
                 80.238.164.0/23, 80.238.168.0-80.238.181.255,
                 80.238.183.0-80.238.186.255, 80.238.190.0/24,
                 80.238.191.111, 80.238.192.0/18,
                 83.101.0.0-83.101.9.255, 83.101.16.0-83.101.39.255,
                 83.101.48.0-83.101.59.255, 83.101.64.0-83.101.89.255,
                 83.101.96.0/20, 85.10.192.0/18,
                 85.208.96.0/24, 87.119.12.0/24,
                 87.120.93.0/24, 88.99.0.0/16,
                 88.198.0.0/16, 88.218.193.107,
                 89.150.192.0/19, 91.99.0.0/16,
                 91.107.128.0/17, 91.190.240.0/21,
                 94.45.160.0/19, 94.74.64.0/18,
                 94.130.0.0/16, 94.244.128.0/18,
                 95.216.0.0/15, 101.44.0.0-101.44.111.255,
                 101.44.144.0-101.44.255.255, 101.46.0.0/20,
                 101.46.32.0-101.46.95.255, 101.46.128.0-101.46.227.255,
                 101.46.232.0-101.46.255.255, 103.84.110.0/24,
                 103.198.203.0/24, 103.215.0.0/23,
                 103.215.3.0/24, 103.239.72.0/24,
                 103.240.156.0/22, 103.255.60.0/22,
                 104.156.155.30, 104.223.120.159,
                 106.203.0.0/16, 110.41.90.0/24,
                 110.41.208.0-110.41.210.255, 110.238.64.0-110.238.96.255,
                 110.238.98.0-110.238.127.255, 110.239.64.0/18,
                 111.91.0.0/17, 111.119.192.0/18,
                 114.119.128.0/18, 115.30.32.0/19,
                 116.202.0.0-116.204.127.255, 119.8.0.0/20,
                 119.8.18.0/24, 119.8.21.0-119.8.224.255,
                 119.8.227.0-119.8.250.255, 119.8.252.0/22,
                 119.12.160.0/20, 119.13.32.0/21,
                 119.13.64.0/18, 119.13.160.0/20,
                 121.37.0.0/16, 121.91.152.0/21,
                 121.91.168.0/21, 121.91.200.0/21,
                 122.8.128.0/18, 124.71.248.0-124.71.250.255,
                 124.71.252.0/23, 124.81.0.0/16,
                 124.156.0.0/16, 124.243.128.0/18,
                 128.140.0.0/17, 129.226.0.0/16,
                 130.162.46.197, 131.255.36.0/22,
                 134.209.102.166, 135.181.0.0/16,
                 136.243.0.0/16, 138.199.128.0/17,
                 138.201.0.0/16, 139.9.98.0/23,
                 139.28.242.0/23, 139.144.52.241,
                 141.11.103.229, 142.132.128.0/17,
                 144.76.0.0/16, 146.174.128.0/18,
                 148.145.192.0/20, 148.145.224.0/23,
                 148.251.0.0/16, 149.232.128.0/19,
                 150.40.128.0/17, 154.81.16.0/20,
                 154.83.0.0/23, 154.83.103.106,
                 154.83.103.205, 154.86.32.0/19,
                 154.93.100.0/23, 154.93.104.0/23,
                 154.220.192.0/19, 156.146.32.0/19,
                 156.227.22.0/23, 156.230.32.0/20,
                 156.230.64.0/18, 156.232.16.0/20,
                 156.240.128.0/18, 156.249.32.0/20,
                 156.253.16.0/20, 157.90.0.0/16,
                 157.180.0.0/17, 157.254.211.0-157.254.212.255,
                 159.69.0.0/16, 159.138.0.0-159.138.71.255,
                 159.138.76.0-159.138.183.255, 159.138.188.0-159.138.221.255,
                 159.138.224.0/19, 160.20.84.0/22,
                 162.55.0.0/16, 162.62.208.0/20,
                 162.128.0.0/16, 163.223.210.0/23,
                 166.108.192.0/18, 167.233.0.0/16,
                 167.235.0.0/16, 168.119.0.0/16,
                 170.39.217.107, 170.39.218.0/24,
                 170.106.0.0/16, 171.25.225.0/24,
                 172.178.59.159, 173.252.83.0/24,
                 176.9.0.0/16, 176.52.128.0/19,
                 178.20.55.16, 178.63.0.0/16,
                 178.212.75.0/24, 180.87.192.0/18,
                 182.160.0.0/19, 182.160.36.0/22,
                 182.160.49.0/24, 182.160.52.0-182.160.63.255,
                 183.87.32.0-183.87.159.255, 185.50.120.0/23,
                 185.107.52.0/22, 185.126.28.0/22,
                 185.157.83.0/24, 185.157.176.0/22,
                 185.170.167.0/24, 185.171.224.0/22,
                 185.177.72.205, 185.189.228.0/22,
                 185.191.171.0/24, 185.213.45.0/24,
                 185.216.237.0/24, 185.226.99.0/24,
                 185.228.8.0/23, 187.19.80.0/20,
                 188.34.128.0/17, 188.40.0.0/16,
                 188.119.192.0/18, 188.239.0.0/18,
                 188.245.0.0/16, 189.1.192.0/18,
                 189.28.96.0/19, 190.92.192.0/18,
                 191.220.0.0/15, 193.41.206.176,
                 193.110.6.0/23, 193.163.198.0/24,
                 194.42.180.0-194.42.187.255, 194.62.106.0/24,
                 195.60.226.0/24, 195.178.110.0/24,
                 195.201.0.0/16, 195.248.224.0/24,
                 197.242.84.0/22, 198.235.24.0/24,
                 201.77.32.0/20, 201.131.3.0/24,
                 202.76.144.0-202.76.191.255, 202.170.88.0/21,
                 203.123.80.0/20, 203.167.20.0-203.167.22.255,
                 204.29.146.0/24, 210.202.31.42,
                 212.34.192.0/19, 213.133.96.0/19,
                 213.239.192.0/18, 213.250.128.0/18,
                 216.55.108.0/22, 219.83.0.0-219.83.47.255,
                 219.83.122.0/24 }
    }


    chain input {
        type filter hook input priority filter; policy accept;
        ip saddr @abuse-http tcp dport { 80, 443 } counter
        ip saddr @abuse-http tcp dport { 80, 443 } reject with icmpx admin-prohibited
        ip saddr @abuse-mail tcp dport { 25, 143, 465, 587, 993, 4545, 65444 } reject with icmpx admin-prohibited
    }
}
